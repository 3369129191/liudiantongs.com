<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>付款单生成系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Times New Roman", Times, serif;
        }
        
        /* 使用index.html的导航栏样式 */
        body {
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            padding: 0;
            margin: 0;
        }
        
        /* 顶部导航栏 */
        .header {
            background-color: #1a365d;
            color: white;
            padding: 0 5%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            margin-left: 10px;
            font-weight: 700;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .logo-icon {
            font-size: 2.2rem;
            color: #00b4d8;
        }
        
        .contact-info {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .contact-info i {
            color: #00b4d8;
            margin-right: 8px;
        }
        
        .contact-info span {
            margin-right: 20px;
        }
        
        /* 主导航栏 */
        .navbar {
            display: flex;
            background-color: #2d4a7c;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-item {
            position: relative;
        }
        
        .nav-link {
            color: white;
            text-decoration: none;
            padding: 16px 24px;
            display: block;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-link:hover {
            background-color: #00b4d8;
        }
        
        /* 下拉菜单 */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            min-width: 220px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-radius: 0 0 8px 8px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .nav-item:hover .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: block;
            padding: 14px 20px;
            color: #333;
            text-decoration: none;
            border-bottom: 1px solid #f0f0f0;
            transition: all 0.2s ease;
        }
        
        .dropdown-item:hover {
            background-color: #f0f8ff;
            color: #1a365d;
            padding-left: 28px;
        }
        
        .dropdown-item i {
            margin-right: 10px;
            color: #00b4d8;
            width: 18px;
            text-align: center;
        }
        
        /* 响应式设计 */
        @media (max-width: 992px) {
            .top-bar {
                flex-direction: column;
                text-align: center;
            }
            
            .contact-info {
                margin-top: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .navbar {
                flex-wrap: wrap;
            }
            
            .nav-item {
                flex: 1 0 50%;
            }
            
            .nav-link {
                text-align: center;
                padding: 14px 10px;
            }
        }
        
        @media (max-width: 768px) {
            .nav-item {
                flex: 1 0 100%;
            }
            
            .dropdown-menu {
                position: static;
                opacity: 1;
                visibility: visible;
                transform: none;
                display: none;
                box-shadow: none;
                border-radius: 0;
                background-color: rgba(0, 0, 0, 0.1);
            }
            
            .nav-item:hover .dropdown-menu {
                display: block;
            }
            
            .dropdown-item {
                color: white;
                border-bottom-color: rgba(255, 255, 255, 0.1);
            }
            
            .dropdown-item:hover {
                background-color: rgba(255, 255, 255, 0.1);
            }
        }
        
        .main-container {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            min-height: calc(100vh - 300px); /* 为页脚留出空间 */
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-panel {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .preview-panel {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: auto;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            width: 100%;
            text-align: center;
        }
        
        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.6rem;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        
        h3 {
            color: #2c3e50;
            margin: 15px 0 10px 0;
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #444;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #2ecc71;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: #e74c3c;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        /* 预览区域样式 */
        .invoice-preview {
            font-size: 12pt;
            line-height: 1.4;
            color: #000;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border: 1px solid #ddd;
            text-align: left !important;
        }
        
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }
        
        .preview-table td {
            padding: 4px 8px;
            vertical-align: top;
            border: 1px solid #000;
        }
        
        .no-border td {
            border: none;
        }
        
        .mark {
            background-color: #FFFF99;
            padding: 1px 3px;
        }
        
        .underline {
            text-decoration: underline;
        }
        
        .bold {
            font-weight: bold;
        }
        
        .center {
            text-align: center;
        }
        
        .right {
            text-align: right;
        }
        
        .document-title {
            font-size: 14pt;
            font-weight: bold;
            margin: 15px 0;
            text-align: left !important;
        }
        
        /* 总计金额区域 - 部分右对齐 */
        .total-amount {
            margin: 15px 0;
            font-weight: bold;
        }
        
        .amount-line {
            margin-bottom: 5px;
        }
        
        .amount-line-right {
            text-align: right;
        }
        
        .amount-line-left {
            text-align: left;
        }
        
        .warning {
            margin: 15px 0;
            font-style: italic;
            text-align: left;
        }
        
        .signature-block {
            margin-top: 30px;
            text-align: left;
        }
        
        .stamp-placeholder {
            width: 150px;
            height: 100px;
            border: 2px dashed #999;
            display: inline-block;
            vertical-align: bottom;
            margin-left: 20px;
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .main-container {
                padding: 10px;
            }
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            font-size: 20px;
        }
        
        .loading.active {
            display: flex;
        }
        
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-message {
            background-color: #2ecc71;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
            display: none;
        }
        
        .section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        /* 产品表格样式 */
        .product-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        
        .product-table th {
            background-color: #f2f2f2;
            padding: 10px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        .product-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        
        .product-table input {
            width: 100%;
            padding: 5px;
        }
        
        .product-actions {
            display: flex;
            gap: 5px;
        }
        
        /* 银行信息表格样式 */
        .bank-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            text-align: left;
        }
        
        .bank-table td {
            border: 1px solid #000;
            padding: 4px 8px;
        }
        
        /* 产品预览表格 */
        .products-preview-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            table-layout: fixed;
            text-align: left;
        }
        
        .products-preview-table td, 
        .products-preview-table th {
            padding: 6px 8px;
            border: 1px solid #000;
            word-wrap: break-word;
        }
        
        .products-preview-table th {
            background-color: #f0f0f0;
            text-align: center;
            font-weight: bold;
        }
        
        .col-no { width: 5%; text-align: center; }
        .col-desc { width: 40%; text-align: left; }
        .col-price { width: 15%; text-align: right; }
        .col-qty { width: 10%; text-align: center; }
        .col-total { width: 15%; text-align: right; }
        
        /* 公司信息样式 */
        .company-info-container {
            border: 1px solid #000;
            padding: 10px;
            margin-bottom: 15px;
            text-align: left;
        }
        
        .company-info-row {
            display: flex;
            margin-bottom: 5px;
            text-align: left;
        }
        
        .company-info-row:last-child {
            margin-bottom: 0;
        }
        
        .company-label {
            width: 140px;
            font-weight: bold;
            flex-shrink: 0;
            text-align: left;
        }
        
        .company-content {
            flex-grow: 1;
            margin-left: 10px;
            text-align: left;
        }
        
        /* 签名区域样式 */
        .signature-line {
            margin-top: 50px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            text-align: left;
        }
        
        .signature-left {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }
        
        .signature-item {
            display: flex;
            flex-direction: column;
            text-align: left;
        }
        
        .signature-title {
            font-weight: bold;
            text-decoration: underline;
            margin-bottom: 10px;
        }
        
        .signature-name {
            text-decoration: underline;
            margin-bottom: 5px;
        }
        
        .signature-role {
            font-size: 11pt;
            margin-top: 2px;
        }
        
        /* 金额对齐容器 */
        .amount-container {
            width: 100%;
        }
        
        .amount-right-content {
            width: 45%;
            text-align: right;
            margin-left: auto;
        }
        
        .amount-left-content {
            text-align: left;
            margin-top: 10px;
        }
        
        /* 面板标题样式 */
        .panel-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #2c3e50;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .panel-header i {
            font-size: 1.4rem;
            color: #3498db;
        }
        
        /* 编辑区域优化 */
        .form-panel {
            max-height: 70vh;
            overflow-y: auto;
        }
        
        /* 预览区域优化 */
        .preview-panel {
            min-height: 600px;
        }
        
        .preview-container {
            max-height: 70vh;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- 使用index.html的导航栏 -->
    <header class="header">
        <div class="top-bar">
            <div class="logo">
                <i class="fas fa-shipping-fast logo-icon"></i>
                <h1>六点通国际贸易服务</h1>
            </div>
            <div class="contact-info">
                <span><i class="fas fa-phone-alt"></i> 400-123-4567</span>
                <span><i class="fas fa-envelope"></i> service@shunda-logistics.com</span>
                <span><i class="fas fa-clock"></i> 周一至周五 9:00-18:00</span>
            </div>
        </div>
        
        <!-- 主导航栏 -->
        <nav class="navbar">
            <div class="nav-item">
                <a href="index.html" class="nav-link"><i class="fas fa-home"></i> 首页</a>
            </div>
            
            <div class="nav-item">
                <a href="#" class="nav-link"><i class="fas fa-globe-americas"></i> 离岸</a>
                <div class="dropdown-menu">
                    <a href="#offshore-contract" class="dropdown-item"><i class="fas fa-file-contract"></i> 货物采购合同</a>
                    <a href="#offshore-agreement" class="dropdown-item"><i class="fas fa-handshake"></i> Договор трехсторонний - 智链三方协议</a>
                    <a href="#offshore-registration" class="dropdown-item"><i class="fas fa-registered"></i> Заявка_на_перевод_от_Образец</a>
                    <a href="#offshore-banking" class="dropdown-item"><i class="fas fa-university"></i> 付款单</a>
                </div>
            </div>
            
            <div class="nav-item">
                <a href="#" class="nav-link"><i class="fas fa-money-check-alt"></i> 本票</a>
                <div class="dropdown-menu">
                    <a href="#promissory-application" class="dropdown-item"><i class="fas fa-edit"></i> 申请流程</a>
                    <a href="#promissory-sample" class="dropdown-item"><i class="fas fa-file-invoice"></i> 样本下载</a>
                    <a href="#promissory-verification" class="dropdown-item"><i class="fas fa-check-circle"></i> 验真服务</a>
                    <a href="#promissory-tracking" class="dropdown-item"><i class="fas fa-search-dollar"></i> 状态查询</a>
                </div>
            </div>
            
            <div class="nav-item">
                <a href="#" class="nav-link"><i class="fas fa-border-style"></i> 白关</a>
                <div class="dropdown-menu">
                    <a href="#clearance-process" class="dropdown-item"><i class="fas fa-tasks"></i> 流程说明</a>
                    <a href="#clearance-documents" class="dropdown-item"><i class="fas fa-folder-open"></i> 所需文件</a>
                    <a href="#clearance-faq" class="dropdown-item"><i class="fas fa-question-circle"></i> 常见问题</a>
                    <a href="#clearance-calculator" class="dropdown-item"><i class="fas fa-calculator"></i> 费用估算</a>
                </div>
            </div>
            
            <div class="nav-item">
                <a href="#" class="nav-link"><i class="fas fa-ad"></i> 广告</a>
                <div class="dropdown-menu">
                    <a href="#advertisement-cooperation" class="dropdown-item"><i class="fas fa-handshake"></i> 合作推广</a>
                    <a href="#advertisement-media" class="dropdown-item"><i class="fas fa-photo-video"></i> 媒体资源</a>
                    <a href="#advertisement-price" class="dropdown-item"><i class="fas fa-tags"></i> 价格方案</a>
                    <a href="#advertisement-design" class="dropdown-item"><i class="fas fa-palette"></i> 设计服务</a>
                </div>
            </div>
            
            <div class="nav-item">
                <a href="#" class="nav-link"><i class="fas fa-truck-loading"></i> 物流</a>
                <div class="dropdown-menu">
                    <a href="#logistics-sea" class="dropdown-item"><i class="fas fa-ship"></i> 海运服务</a>
                    <a href="#logistics-air" class="dropdown-item"><i class="fas fa-plane"></i> 空运服务</a>
                    <a href="#logistics-land" class="dropdown-item"><i class="fas fa-truck"></i> 陆运服务</a>
                    <a href="#logistics-warehouse" class="dropdown-item"><i class="fas fa-warehouse"></i> 仓储服务</a>
                    <a href="#logistics-tracking" class="dropdown-item"><i class="fas fa-map-marked-alt"></i> 货物追踪</a>
                </div>
            </div>
        </nav>
    </header>
    
    <div class="main-container">
        <div class="container">
            <h1><i class="fas fa-file-invoice-dollar"></i> 付款单自动化生成系统</h1>
            
            <!-- 上面编辑区域 -->
            <div class="form-panel">
                <div class="panel-header">
                    <i class="fas fa-edit"></i>
                    <h2>输入数据</h2>
                </div>
                
                <!-- 银行信息部分 -->
                <div class="section">
                    <h3><i class="fas fa-university"></i> 银行信息</h3>
                    <div class="form-group">
                        <label for="bank-name">银行名称</label>
                        <input type="text" id="bank-name" value='ФИЛИАЛ "ЦЕНТРАЛЬНЫЙ" БАНКА ВТБ (ПАО)'>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bik">БИК</label>
                            <input type="text" id="bik" value="044525187">
                        </div>
                        <div class="form-group">
                            <label for="account-number">Сч. №</label>
                            <input type="text" id="account-number" value="30101810700000000187">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="inn">ИНН</label>
                            <input type="text" id="inn" value="9909721327">
                        </div>
                        <div class="form-group">
                            <label for="kpp">КПП</label>
                            <input type="text" id="kpp" value="784287001">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="recipient-account">Сч. № получателя</label>
                        <input type="text" id="recipient-account" value="40807810826800000051">
                    </div>
                    <div class="form-group">
                        <label for="recipient-name">Получатель</label>
                        <input type="text" id="recipient-name" value="СМАРТЧЭЙН НЕКСУС ЛИМИТЕД">
                    </div>
                </div>
                
                <!-- 发票信息部分 -->
                <div class="section">
                    <h3><i class="fas fa-file-invoice"></i> 发票信息</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="invoice-number">发票号</label>
                            <input type="text" id="invoice-number" value="011">
                        </div>
                        <div class="form-group">
                            <label for="invoice-date">发票日期</label>
                            <input type="text" id="invoice-date" value="03 Январь 2026 года">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contract-number">合同号</label>
                            <input type="text" id="contract-number" value="SSSC20260103">
                        </div>
                        <div class="form-group">
                            <label for="contract-date">合同日期</label>
                            <input type="text" id="contract-date" value="03 Январь 2026 года.">
                        </div>
                    </div>
                </div>
                
                <!-- 公司信息部分 -->
                <div class="section">
                    <h3><i class="fas fa-building"></i> 公司信息</h3>
                    <div class="form-group">
                        <label for="seller-name">Продавец</label>
                        <input type="text" id="seller-name" value="SHENZHEN JINGYING OPTOELECTRONIC TECHNOLOGY CO., Ltd">
                    </div>
                    <div class="form-group">
                        <label for="buyer-name">Покупатель</label>
                        <input type="text" id="buyer-name" value='ООО «TЫCЯЧA BOЛH»'>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="buyer-inn">Покупатель ИНН</label>
                            <input type="text" id="buyer-inn" value="9726091614">
                        </div>
                        <div class="form-group">
                            <label for="buyer-kpp">Покупатель КПП</label>
                            <input type="text" id="buyer-kpp" value="770101001">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="buyer-address">Покупатель адрес</label>
                        <textarea id="buyer-address">117105, город Москва, Новоданиловская наб, д. 12, помещ. 81</textarea>
                    </div>
                    <div class="form-group">
                        <label for="recipient-address">Получатель адрес</label>
                        <textarea id="recipient-address">ПОМЕЩЕНИЕ/КОМНАТА А27, ЭТАЖ 24, РИДЖЕНТС ПАРК ПРИНС ИНДАСТРИАЛ БИЛДИНГ №706, ПРИНС ЭДВАРД РОАД, ВОСТОЧНЫЙ КОУЛУН, Гонконг, КНР</textarea>
                    </div>
                </div>
                
                <!-- 商品信息部分 -->
                <div class="section">
                    <h3><i class="fas fa-boxes"></i> 商品信息</h3>
                    <div id="products-container">
                        <table class="product-table">
                            <thead>
                                <tr>
                                    <th>NO.</th>
                                    <th>ОПИСАНИЕ ТОВАРОВ</th>
                                    <th>ЦЕНА ЗА ЕДИНИЦУ (RUB)</th>
                                    <th>КОЛИЧЕСТВО</th>
                                    <th>СУММА (RUB)</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="product-rows">
                                <!-- 产品行将通过JavaScript动态生成 -->
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <button class="btn btn-sm" onclick="addProductRow()">
                            <i class="fas fa-plus"></i> 添加产品
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="clearAllProducts()">
                            <i class="fas fa-trash"></i> 清空所有产品
                        </button>
                    </div>
                </div>
                
                <!-- 总计信息部分 -->
                <div class="section">
                    <h3><i class="fas fa-calculator"></i> 总计信息</h3>
                    <div class="form-group">
                        <label for="total-in-words">总计金额（文字）</label>
                        <textarea id="total-in-words">Сумма прописью Два миллиона сто шестьдесят одна тысяча восемьдесят четыре рубля</textarea>
                    </div>
                    <div class="form-group">
                        <label for="director-name">Руководитель</label>
                        <input type="text" id="director-name" value="Ли Цзяньвэнь">
                    </div>
                </div>
                
                <!-- 操作按钮 -->
                <div class="button-group">
                    <button class="btn" onclick="updatePreview()">
                        <i class="fas fa-sync-alt"></i> 更新预览
                    </button>
                    <button class="btn btn-success" onclick="generateWordDocument()">
                        <i class="fas fa-file-word"></i> 生成Word文档
                    </button>
                    <button class="btn btn-danger" onclick="resetForm()">
                        <i class="fas fa-redo"></i> 重置表单
                    </button>
                </div>
                
                <div id="success-message" class="success-message">
                    <i class="fas fa-check-circle"></i> Word文档生成成功！
                </div>
            </div>
            
            <!-- 下面预览区域 -->
            <div class="preview-panel">
                <div class="panel-header">
                    <i class="fas fa-eye"></i>
                    <h2>预览</h2>
                </div>
                <div class="preview-container">
                    <div class="invoice-preview" id="invoice-preview">
                        <!-- 预览内容将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 使用index.html的页脚 -->
    <footer class="footer" style="background-color: #1a365d; color: white; padding: 60px 5% 30px; margin-top: 40px;">
        <div class="footer-content" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 40px;">
            <div class="footer-column">
                <h3 style="font-size: 1.4rem; margin-bottom: 25px; color: #00b4d8; position: relative; padding-bottom: 10px;">六点通国际贸易服务</h3>
                <p>我们致力于为全球客户提供专业、高效、安全的跨境物流与商务解决方案。20年行业经验，服务网络覆盖全球150多个国家和地区。</p>
                <p style="margin-top: 15px;"><i class="fas fa-map-marker-alt"></i> 深圳市前海荣超滨海大厦B座211室</p>
                <p style="margin-top: 10px;"><i class="fas fa-map-marker-alt"></i> 厦门市海沧区融信中心2001室</p>
            </div>
            
            <div class="footer-column">
                <h3 style="font-size: 1.4rem; margin-bottom: 25px; color: #00b4d8; position: relative; padding-bottom: 10px;">服务导航</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 12px;"><a href="index.html" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;">首页</a></li>
                    <li style="margin-bottom: 12px;"><a href="#offshore-contract" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;">离岸合同</a></li>
                    <li style="margin-bottom: 12px;"><a href="#promissory-application" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;">本票申请</a></li>
                    <li style="margin-bottom: 12px;"><a href="#clearance-process" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;">白关流程</a></li>
                    <li style="margin-bottom: 12px;"><a href="#advertisement-cooperation" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;">广告合作</a></li>
                    <li style="margin-bottom: 12px;"><a href="#logistics-sea" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;">海运服务</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3 style="font-size: 1.4rem; margin-bottom: 25px; color: #00b4d8; position: relative; padding-bottom: 10px;">联系我们</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 12px;"><i class="fas fa-phone"></i> 400-123-4567</li>
                    <li style="margin-bottom: 12px;"><i class="fas fa-phone"></i> +86 21 1234 5678</li>
                    <li style="margin-bottom: 12px;"><i class="fas fa-envelope"></i> service@shunda-logistics.com</li>
                    <li style="margin-bottom: 12px;"><i class="fas fa-clock"></i> 周一至周五 9:00-18:00</li>
                    <li style="margin-bottom: 12px;"><i class="fas fa-clock"></i> 紧急热线 24小时</li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3 style="font-size: 1.4rem; margin-bottom: 25px; color: #00b4d8; position: relative; padding-bottom: 10px;">关注我们</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 12px;"><a href="#" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;"><i class="fab fa-weixin"></i> 微信公众号</a></li>
                    <li style="margin-bottom: 12px;"><a href="#" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
                    <li style="margin-bottom: 12px;"><a href="#" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;"><i class="fab fa-twitter"></i> Twitter</a></li>
                    <li style="margin-bottom: 12px;"><a href="#" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;"><i class="fab fa-facebook"></i> Facebook</a></li>
                    <li style="margin-bottom: 12px;"><a href="#" style="color: #ccc; text-decoration: none; transition: color 0.2s ease;"><i class="fas fa-newspaper"></i> 行业资讯订阅</a></li>
                </ul>
            </div>
        </div>
        
        <div class="copyright" style="text-align: center; padding-top: 30px; border-top: 1px solid rgba(255, 255, 255, 0.1); color: #aaa; font-size: 0.9rem;">
            <p>© 2023 深圳六点通跨境企业服务有限公司 版权所有 | 沪ICP备12345678号</p>
            <p style="margin-top: 10px;">国际物流服务专家 | 20年跨境物流经验</p>
        </div>
    </footer>
    
    <!-- 加载动画 -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div>正在生成Word文档...</div>
    </div>

    <!-- 引入Docx库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.8.0/build/index.min.js"></script>
    
    <script>
        // 产品数据数组
        let products = [
            { id: 1, name: "Air Fryer KQ-503", price: 1432.64, quantity: 1000 },
            { id: 2, name: "Air Fryer CM605D", price: 1821.11, quantity: 400 }
        ];
        let nextProductId = 3;
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            renderProductRows();
            updatePreview();
            
            // 添加导航菜单点击事件（index.html风格）
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    if (window.innerWidth <= 768) {
                        const dropdown = this.nextElementSibling;
                        if (dropdown && dropdown.classList.contains('dropdown-menu')) {
                            e.preventDefault();
                            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                        }
                    }
                });
            });
        });
        
        // 渲染产品行
        function renderProductRows() {
            const container = document.getElementById('product-rows');
            container.innerHTML = '';
            
            products.forEach((product, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><input type="text" value="${product.name}" onchange="updateProduct(${product.id}, 'name', this.value)"></td>
                    <td><input type="number" step="0.01" value="${product.price}" onchange="updateProduct(${product.id}, 'price', parseFloat(this.value))"></td>
                    <td><input type="number" value="${product.quantity}" onchange="updateProduct(${product.id}, 'quantity', parseInt(this.value))"></td>
                    <td>${formatNumber(product.price * product.quantity)}</td>
                    <td class="product-actions">
                        <button class="btn btn-sm btn-danger" onclick="removeProduct(${product.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                container.appendChild(row);
            });
            
            // 更新预览
            updatePreview();
        }
        
        // 添加产品行
        function addProductRow() {
            const newProduct = {
                id: nextProductId++,
                name: "新产品",
                price: 0,
                quantity: 1
            };
            products.push(newProduct);
            renderProductRows();
        }
        
        // 更新产品
        function updateProduct(id, field, value) {
            const product = products.find(p => p.id === id);
            if (product) {
                product[field] = value;
                renderProductRows();
            }
        }
        
        // 删除产品
        function removeProduct(id) {
            products = products.filter(p => p.id !== id);
            renderProductRows();
        }
        
        // 清空所有产品
        function clearAllProducts() {
            if (confirm("确定要清空所有产品吗？")) {
                products = [];
                renderProductRows();
            }
        }
        
        // 计算总额
        function calculateTotals() {
            let subtotal = 0;
            products.forEach(product => {
                subtotal += product.price * product.quantity;
            });
            return {
                subtotal: subtotal,
                formattedSubtotal: formatNumber(subtotal)
            };
        }
        
        // 更新预览
        function updatePreview() {
            const preview = document.getElementById('invoice-preview');
            
            // 收集表单数据
            const data = collectFormData();
            
            // 计算总额
            const totals = calculateTotals();
            
            // 生成预览HTML
            preview.innerHTML = `
                <table class="bank-table">
                    <tr>
                        <td rowspan="3" width="60%" class="bold">
                            <span class="mark">${data.bankName}</span>
                            <div>Банк получателя</div>
                        </td>
                        <td width="10%" class="bold">БИК</td>
                        <td width="30%"><span class="mark">${data.bik}</span></td>
                    </tr>
                    <tr>
                        <td class="bold">Сч. №</td>
                        <td><span class="mark">${data.accountNumber}</span></td>
                    </tr>
                    <tr>
                        <td colspan="2" class="bold">
                            <table class="no-border" style="width:100%;">
                                <tr>
                                    <td width="30%" class="bold">ИНН</td>
                                    <td width="30%" class="bold">КПП</td>
                                    <td width="40%" class="bold">Сч. №</td>
                                </tr>
                                <tr>
                                    <td><span class="mark">${data.inn}</span></td>
                                    <td><span class="mark">${data.kpp}</span></td>
                                    <td><span class="mark">${data.recipientAccount}</span></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <span class="mark">${data.recipientName}</span>
                            <div>Получатель</div>
                        </td>
                    </tr>
                </table>
                
                <div class="document-title">
                    Счет на оплату № <span class="underline">${data.invoiceNumber}</span> от <span class="underline">${data.invoiceDate}</span>
                </div>
                
                <div class="company-info-container">
                    <div class="company-info-row">
                        <div class="company-label">Продавец</div>
                        <div class="company-content">
                            <div class="bold underline mark">${data.sellerName}</div>
                        </div>
                    </div>
                    <div class="company-info-row">
                        <div class="company-label">Получатель</div>
                        <div class="company-content">
                            <div class="mark">${data.recipientName} ИНН ${data.inn} КПП ${data.kpp}</div>
                            <div class="mark company-info-line">Адрес: ${data.recipientAddress}</div>
                        </div>
                    </div>
                    <div class="company-info-row">
                        <div class="company-label">Покупатель</div>
                        <div class="company-content">
                            <div class="bold underline mark">${data.buyerName}</div>
                            <div class="mark company-info-line">,ИНН <span class="underline mark">${data.buyerInn}</span> ,КПП <span class="underline mark">${data.buyerKpp}</span>, Адрес: <span class="underline mark">${data.buyerAddress}</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="bold">
                    Основание договор ：<span class="underline mark">${data.contractNumber}</span> от <span class="underline mark">${data.contractDate}</span>
                </div>
                
                <table class="products-preview-table">
                    <tr>
                        <th class="col-no">NO.</th>
                        <th class="col-desc">ОПИСАНИЕ ТОВАРОВ</th>
                        <th class="col-price">ЦЕНА ЗА ЕДИНИЦУ</th>
                        <th class="col-qty">КОЛИЧЕСТВО</th>
                        <th class="col-total">СУММА</th>
                    </tr>
                    ${products.map((product, index) => `
                        <tr>
                            <td class="col-no">${index + 1}</td>
                            <td class="col-desc"><span class="mark">${product.name}</span></td>
                            <td class="col-price"><span class="mark">${formatNumber(product.price)} RUB</span></td>
                            <td class="col-qty"><span class="mark">${product.quantity}</span></td>
                            <td class="col-total"><span class="mark">${formatNumber(product.price * product.quantity)} RUB</span></td>
                        </tr>
                    `).join('')}
                </table>
                
                <div class="amount-container">
                    <div class="amount-right-content">
                        <div class="amount-line amount-line-right">
                            СУММА： <span class="mark">${totals.formattedSubtotal} RUB</span>
                        </div>
                        <div class="amount-line amount-line-right">
                            НДС: без ндс
                        </div>
                        <div class="amount-line amount-line-right">
                            Всего к оплате：<span class="mark">${totals.formattedSubtotal} RUB</span>
                        </div>
                    </div>
                    
                    <div class="amount-left-content">
                        <div class="amount-line amount-line-left">
                            Всего <span class="mark">${products.length}</span> позиция, общая сумма составляет <span class="mark">${totals.formattedSubtotal.replace(/\s/g, '')}</span> рублей 00 копеек
                        </div>
                        <div class="amount-line amount-line-left">
                            Сумма прописью: <span class="underline mark">${data.totalInWords}</span>
                        </div>
                    </div>
                </div>
                
                <div class="warning">
                    <div class="bold">Внимание!</div>
                    <div>
                        Оплата данного счета-фактуры подразумевает принятие условий доставки товаров. Уведомление о платеже является обязательным, в противном случае нельзя гарантировать наличие товара на складе. Товары будут предоставлены после поступления оплаты на расчетный счет поставщика. Самовывоз возможен только при наличии доверенности и паспорта.
                    </div>
                </div>
                
                <div class="signature-line">
                    <div class="signature-left">
                        <div class="signature-item">
                            <div class="signature-title">Руководитель</div>
                            <div class="signature-name mark">${data.directorName}</div>
                            <div class="signature-role">(Руководитель)</div>
                        </div>
                        <div class="signature-item">
                            <div class="signature-title">Бухгалтер</div>
                            <div class="signature-name mark">${data.directorName}</div>
                            <div class="signature-role">(Бухгалтер)</div>
                        </div>
                    </div>
                    <div class="stamp-placeholder"></div>
                </div>
                <div style="margin-top: 10px;">
                    <span class="bold underline">Печать организации</span>
                </div>
            `;
        }
        
        // 收集表单数据
        function collectFormData() {
            return {
                bankName: document.getElementById('bank-name').value,
                bik: document.getElementById('bik').value,
                accountNumber: document.getElementById('account-number').value,
                inn: document.getElementById('inn').value,
                kpp: document.getElementById('kpp').value,
                recipientAccount: document.getElementById('recipient-account').value,
                recipientName: document.getElementById('recipient-name').value,
                recipientAddress: document.getElementById('recipient-address').value,
                invoiceNumber: document.getElementById('invoice-number').value,
                invoiceDate: document.getElementById('invoice-date').value,
                contractNumber: document.getElementById('contract-number').value,
                contractDate: document.getElementById('contract-date').value,
                sellerName: document.getElementById('seller-name').value,
                buyerName: document.getElementById('buyer-name').value,
                buyerInn: document.getElementById('buyer-inn').value,
                buyerKpp: document.getElementById('buyer-kpp').value,
                buyerAddress: document.getElementById('buyer-address').value,
                totalInWords: document.getElementById('total-in-words').value,
                directorName: document.getElementById('director-name').value
            };
        }
        
        // 数字格式化函数
        function formatNumber(num) {
            return num.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$& ');
        }
        
        // 重置表单
        function resetForm() {
            document.getElementById('bank-name').value = 'ФИЛИАЛ "ЦЕНТРАЛЬНЫЙ" БАНКА ВТБ (ПАО)';
            document.getElementById('bik').value = '044525187';
            document.getElementById('account-number').value = '30101810700000000187';
            document.getElementById('inn').value = '9909721327';
            document.getElementById('kpp').value = '784287001';
            document.getElementById('recipient-account').value = '40807810826800000051';
            document.getElementById('recipient-name').value = 'СМАРТЧЭЙН НЕКСУС ЛИМИТЕД';
            document.getElementById('recipient-address').value = 'ПОМЕЩЕНИЕ/КОМНАТА А27, ЭТАЖ 24, РИДЖЕНТС ПАРК ПРИНС ИНДАСТРИАЛ БИЛДИНГ №706, ПРИНС ЭДВАРД РОАД, ВОСТОЧНЫЙ КОУЛУН, Гонконг, КНР';
            document.getElementById('invoice-number').value = '011';
            document.getElementById('invoice-date').value = '03 Январь 2026 года';
            document.getElementById('contract-number').value = 'SSSC20260103';
            document.getElementById('contract-date').value = '03 Январь 2026 года.';
            document.getElementById('seller-name').value = 'SHENZHEN JINGYING OPTOELECTRONIC TECHNOLOGY CO., Ltd';
            document.getElementById('buyer-name').value = 'ООО «TЫCЯЧA BOЛH»';
            document.getElementById('buyer-inn').value = '9726091614';
            document.getElementById('buyer-kpp').value = '770101001';
            document.getElementById('buyer-address').value = '117105, город Москва, Новоданиловская наб, д. 12, помещ. 81';
            document.getElementById('total-in-words').value = 'Сумма прописью Два миллиона сто шестьдесят одна тысяча восемьдесят четыре рубля';
            document.getElementById('director-name').value = 'Ли Цзяньвэнь';
            
            // 重置产品数据
            products = [
                { id: 1, name: "Air Fryer KQ-503", price: 1432.64, quantity: 1000 },
                { id: 2, name: "Air Fryer CM605D", price: 1821.11, quantity: 400 }
            ];
            nextProductId = 3;
            
            renderProductRows();
            updatePreview();
        }
        
        // 生成Word文档
        async function generateWordDocument() {
            // 显示加载动画
            document.getElementById('loading').classList.add('active');
            
            try {
                // 收集数据
                const data = collectFormData();
                const totals = calculateTotals();
                
                // 创建Word文档
                const doc = new docx.Document({
                    sections: [{
                        properties: {},
                        children: [
                            // 银行信息表格
                            new docx.Table({
                                rows: [
                                    new docx.TableRow({
                                        children: [
                                            new docx.TableCell({
                                                rowSpan: 3,
                                                width: { size: 60, type: docx.WidthType.PERCENTAGE },
                                                children: [
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun({
                                                                text: data.bankName,
                                                                highlight: "yellow"
                                                            })
                                                        ]
                                                    }),
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun("Банк получателя")
                                                        ]
                                                    })
                                                ]
                                            }),
                                            new docx.TableCell({
                                                children: [
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun("БИК")
                                                        ]
                                                    })
                                                ]
                                            }),
                                            new docx.TableCell({
                                                children: [
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun({
                                                                text: data.bik,
                                                                highlight: "yellow"
                                                            })
                                                        ]
                                                    })
                                                ]
                                            })
                                        ]
                                    }),
                                    new docx.TableRow({
                                        children: [
                                            new docx.TableCell({
                                                children: [
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun("Сч. №")
                                                        ]
                                                    })
                                                ]
                                            }),
                                            new docx.TableCell({
                                                children: [
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun({
                                                                text: data.accountNumber,
                                                                highlight: "yellow"
                                                            })
                                                        ]
                                                    })
                                                ]
                                            })
                                        ]
                                    }),
                                    new docx.TableRow({
                                        children: [
                                            new docx.TableCell({
                                                columnSpan: 2,
                                                children: [
                                                    new docx.Table({
                                                        rows: [
                                                            new docx.TableRow({
                                                                children: [
                                                                    new docx.TableCell({
                                                                        children: [
                                                                            new docx.Paragraph({
                                                                                children: [
                                                                                    new docx.TextRun("ИНН")
                                                                                ]
                                                                            })
                                                                        ]
                                                                    }),
                                                                    new docx.TableCell({
                                                                        children: [
                                                                            new docx.Paragraph({
                                                                                children: [
                                                                                    new docx.TextRun("КПП")
                                                                                ]
                                                                            })
                                                                        ]
                                                                    }),
                                                                    new docx.TableCell({
                                                                        children: [
                                                                            new docx.Paragraph({
                                                                                children: [
                                                                                    new docx.TextRun("Сч. №")
                                                                                ]
                                                                            })
                                                                        ]
                                                                    })
                                                                ]
                                                            }),
                                                            new docx.TableRow({
                                                                children: [
                                                                    new docx.TableCell({
                                                                        children: [
                                                                            new docx.Paragraph({
                                                                                children: [
                                                                                    new docx.TextRun({
                                                                                        text: data.inn,
                                                                                        highlight: "yellow"
                                                                                    })
                                                                                ]
                                                                            })
                                                                        ]
                                                                    }),
                                                                    new docx.TableCell({
                                                                        children: [
                                                                            new docx.Paragraph({
                                                                                children: [
                                                                                    new docx.TextRun({
                                                                                        text: data.kpp,
                                                                                        highlight: "yellow"
                                                                                    })
                                                                                ]
                                                                            })
                                                                        ]
                                                                    }),
                                                                    new docx.TableCell({
                                                                        children: [
                                                                            new docx.Paragraph({
                                                                                children: [
                                                                                    new docx.TextRun({
                                                                                        text: data.recipientAccount,
                                                                                        highlight: "yellow"
                                                                                    })
                                                                                ]
                                                                            })
                                                                        ]
                                                                    })
                                                                ]
                                                            })
                                                        ]
                                                    })
                                                ]
                                            })
                                        ]
                                    }),
                                    new docx.TableRow({
                                        children: [
                                            new docx.TableCell({
                                                columnSpan: 3,
                                                children: [
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun({
                                                                text: data.recipientName,
                                                                highlight: "yellow"
                                                            })
                                                        ]
                                                    }),
                                                    new docx.Paragraph({
                                                        children: [
                                                            new docx.TextRun("Получатель")
                                                        ]
                                                    })
                                                ]
                                            })
                                        ]
                                    })
                                ]
                            }),
                            
                            // 发票标题（靠左对齐）
                            new docx.Paragraph({
                                text: `Счет на оплату № ${data.invoiceNumber} от ${data.invoiceDate}`,
                                alignment: docx.AlignmentType.LEFT,
                                bold: true
                            }),
                            
                            // 买卖方信息（保留Продавец/Получатель/Покупатель标签）
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Продавец"),
                                    new docx.TextRun({
                                        text: "     ",
                                        bold: false
                                    }),
                                    new docx.TextRun({
                                        text: data.sellerName,
                                        highlight: "yellow",
                                        bold: true,
                                        underline: {}
                                    })
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Получатель"),
                                    new docx.TextRun({
                                        text: "     ",
                                        bold: false
                                    }),
                                    new docx.TextRun({
                                        text: `${data.recipientName} ИНН ${data.inn} КПП ${data.kpp}`,
                                        highlight: "yellow"
                                    })
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "               ",
                                        bold: false
                                    }),
                                    new docx.TextRun({
                                        text: `Адрес: ${data.recipientAddress}`,
                                        highlight: "yellow"
                                    })
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Покупатель"),
                                    new docx.TextRun({
                                        text: "     ",
                                        bold: false
                                    }),
                                    new docx.TextRun({
                                        text: data.buyerName,
                                        highlight: "yellow",
                                        bold: true,
                                        underline: {}
                                    })
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "               ",
                                        bold: false
                                    }),
                                    new docx.TextRun(",ИНН "),
                                    new docx.TextRun({
                                        text: data.buyerInn,
                                        highlight: "yellow",
                                        underline: {}
                                    }),
                                    new docx.TextRun(" ,КПП "),
                                    new docx.TextRun({
                                        text: data.buyerKpp,
                                        highlight: "yellow",
                                        underline: {}
                                    }),
                                    new docx.TextRun(", Адрес: "),
                                    new docx.TextRun({
                                        text: data.buyerAddress,
                                        highlight: "yellow",
                                        underline: {}
                                    })
                                ]
                            }),
                            
                            // 合同依据
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Основание договор ："),
                                    new docx.TextRun({
                                        text: data.contractNumber,
                                        highlight: "yellow",
                                        underline: {}
                                    }),
                                    new docx.TextRun(" от "),
                                    new docx.TextRun({
                                        text: data.contractDate,
                                        highlight: "yellow",
                                        underline: {}
                                    })
                                ],
                                bold: true
                            }),
                            
                            // 商品表格（表格左对齐，表头文案居中）
                            new docx.Table({
                                columnWidths: [500, 2500, 1000, 800, 1200],
                                alignment: docx.AlignmentType.LEFT,
                                rows: [
                                    new docx.TableRow({
                                        children: [
                                            new docx.TableCell({
                                                children: [new docx.Paragraph({ text: "NO.", alignment: docx.AlignmentType.CENTER, bold: true })]
                                            }),
                                            new docx.TableCell({
                                                children: [new docx.Paragraph({ text: "ОПИСАНИЕ ТОВАРОВ", bold: true })]
                                            }),
                                            new docx.TableCell({
                                                children: [new docx.Paragraph({ text: "ЦЕНА ЗА ЕДИНИЦУ", bold: true })]
                                            }),
                                            new docx.TableCell({
                                                children: [new docx.Paragraph({ text: "КОЛИЧЕСТВО", bold: true })]
                                            }),
                                            new docx.TableCell({
                                                children: [new docx.Paragraph({ text: "СУММА", bold: true })]
                                            })
                                        ]
                                    }),
                                    ...products.map((product, index) => 
                                        new docx.TableRow({
                                            children: [
                                                new docx.TableCell({
                                                    children: [new docx.Paragraph({ text: (index + 1).toString(), alignment: docx.AlignmentType.CENTER })]
                                                }),
                                                new docx.TableCell({
                                                    children: [
                                                        new docx.Paragraph({
                                                            children: [
                                                                new docx.TextRun({
                                                                    text: product.name,
                                                                    highlight: "yellow"
                                                                })
                                                            ]
                                                        })
                                                    ]
                                                }),
                                                new docx.TableCell({
                                                    children: [
                                                        new docx.Paragraph({
                                                            text: `${formatNumber(product.price)} RUB`,
                                                            alignment: docx.AlignmentType.RIGHT
                                                        })
                                                    ]
                                                }),
                                                new docx.TableCell({
                                                    children: [
                                                        new docx.Paragraph({
                                                            text: product.quantity.toString(),
                                                            alignment: docx.AlignmentType.CENTER
                                                        })
                                                    ]
                                                }),
                                                new docx.TableCell({
                                                    children: [
                                                        new docx.Paragraph({
                                                            text: `${formatNumber(product.price * product.quantity)} RUB`,
                                                            alignment: docx.AlignmentType.RIGHT
                                                        })
                                                    ]
                                                })
                                            ]
                                        })
                                    )
                                ]
                            }),
                            
                            // 总计信息（部分右对齐，部分左对齐）
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("СУММА： "),
                                    new docx.TextRun({
                                        text: `${totals.formattedSubtotal} RUB`,
                                        highlight: "yellow"
                                    })
                                ],
                                alignment: docx.AlignmentType.RIGHT
                            }),
                            new docx.Paragraph({
                                text: "НДС: без ндс",
                                alignment: docx.AlignmentType.RIGHT
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Всего к оплате："),
                                    new docx.TextRun({
                                        text: `${totals.formattedSubtotal} RUB`,
                                        highlight: "yellow"
                                    })
                                ],
                                alignment: docx.AlignmentType.RIGHT
                            }),
                            // "Всего X позиция..." 左对齐
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Всего "),
                                    new docx.TextRun({
                                        text: products.length.toString(),
                                        highlight: "yellow"
                                    }),
                                    new docx.TextRun(" позиция, общая сумма составляет "),
                                    new docx.TextRun({
                                        text: totals.formattedSubtotal.replace(/\s/g, ''),
                                        highlight: "yellow"
                                    }),
                                    new docx.TextRun(" рублей 00 копеек")
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Сумма прописью: "),
                                    new docx.TextRun({
                                        text: data.totalInWords,
                                        highlight: "yellow",
                                        underline: {}
                                    })
                                ]
                            }),
                            
                            // 警告信息
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Внимание!", { bold: true })
                                ]
                            }),
                            new docx.Paragraph({
                                text: "Оплата данного счета-фактуры подразумевает принятие условий доставки товаров. Уведомление о платеже является обязательным, в противном случае нельзя гарантировать наличие товара на складе. Товары будут предоставлены после поступления оплаты на расчетный счет поставщика. Самовывоз возможен только при наличии доверенности и паспорта."
                            }),
                            
                            // 签名部分（合并到Ли Цзяньвэнь）
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Руководитель", { underline: {} }),
                                    new docx.TextRun(" "),
                                    new docx.TextRun({
                                        text: data.directorName,
                                        underline: {}
                                    })
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Бухгалтер", { underline: {} }),
                                    new docx.TextRun(" "),
                                    new docx.TextRun({
                                        text: data.directorName,
                                        underline: {}
                                    })
                                ]
                            }),
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun("Печать организации", { underline: {} })
                                ]
                            })
                        ]
                    }]
                });
                
                // 生成文档并下载
                const blob = await docx.Packer.toBlob(doc);
                
                // 保存文件
                saveAs(blob, `Счет_на_оплату_${data.invoiceNumber}_${new Date().toISOString().slice(0,10)}.docx`);
                
                // 隐藏加载动画
                document.getElementById('loading').classList.remove('active');
                
                // 显示成功消息
                const successMsg = document.getElementById('success-message');
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);
                
            } catch (error) {
                console.error('生成Word文档时出错:', error);
                document.getElementById('loading').classList.remove('active');
                alert('生成Word文档时出错: ' + error.message);
            }
        }
    </script>
</body>
</html>